
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Taller de Imputación de Datos &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="&lt;no title&gt;" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Taller de Imputación de Datos</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Taller de Imputación de Datos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importar-librerias">Importar Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-de-datos">Lectura de Datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-numericas">Variables Númericas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-categoricas">Variables Categóricas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#valores-nulos">Valores Nulos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-barras-de-los-valores-nulos">Gráfico de Barras de los Valores Nulos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapa-de-calor-de-los-valores-nulos">Mapa de Calor de los Valores Nulos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-del-tipo-de-dato-faltante-y-discusion-sobre-su-imputabilidad">Clasificación del Tipo de Dato Faltante y Discusión sobre su Imputabilidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-en-variables-numericas">Imputación en Variables Númericas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-edad">Variable ‘edad’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-altura-cm-y-gasto-mensual">Variables ‘altura_cm’ y ‘gasto_mensual’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-ingreso">Variable ‘ingreso’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-demanda">Variable ‘demanda’</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-en-variables-categoricas">Imputación en Variables Categóricas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-sexo-y-ciudad">Variables ‘sexo’ y ‘ciudad’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-nivel-educativo-y-segmento">Variables ‘nivel_educativo’ y ‘segmento’</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-resumen">Tabla Resumen</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="taller-de-imputacion-de-datos">
<h1>Taller de Imputación de Datos<a class="headerlink" href="#taller-de-imputacion-de-datos" title="Link to this heading">#</a></h1>
<section id="importar-librerias">
<h2>Importar Librerías<a class="headerlink" href="#importar-librerias" title="Link to this heading">#</a></h2>
<p>Se importan las librerías esenciales para facilitar el análisis que abarca la carga de datos, la evaluación estadística, la visualización, la transformación de datos, la fusión y la unión.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ks_2samp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNNImputer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lectura-de-datos">
<h2>Lectura de Datos<a class="headerlink" href="#lectura-de-datos" title="Link to this heading">#</a></h2>
<p>La base de datos fue importada directamente desde GitHub utilizando pandas, facilitando el acceso a los datos sin necesidad de descargas manuales intermedias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/Kalbam/Datos/refs/heads/main/base_imputacion_mixta_1000.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se muestran las primeras filas del DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fecha</th>
      <th>sexo</th>
      <th>ciudad</th>
      <th>nivel_educativo</th>
      <th>segmento</th>
      <th>estado_civil</th>
      <th>edad</th>
      <th>altura_cm</th>
      <th>ingresos</th>
      <th>gasto_mensual</th>
      <th>puntuacion_credito</th>
      <th>demanda</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2024-01-01</td>
      <td>F</td>
      <td>Medellín</td>
      <td>NaN</td>
      <td>B</td>
      <td>Unión libre</td>
      <td>19.0</td>
      <td>161.821754</td>
      <td>3574.753806</td>
      <td>1832.731832</td>
      <td>640.465372</td>
      <td>119.202995</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2024-01-02</td>
      <td>F</td>
      <td>Barranquilla</td>
      <td>NaN</td>
      <td>B</td>
      <td>NaN</td>
      <td>52.0</td>
      <td>167.819566</td>
      <td>3163.626815</td>
      <td>NaN</td>
      <td>533.108430</td>
      <td>124.457874</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2024-01-03</td>
      <td>M</td>
      <td>Bogotá</td>
      <td>Secundaria</td>
      <td>B</td>
      <td>Soltero/a</td>
      <td>38.0</td>
      <td>165.756219</td>
      <td>2765.672259</td>
      <td>1219.535074</td>
      <td>491.016910</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2024-01-04</td>
      <td>F</td>
      <td>Bogotá</td>
      <td>NaN</td>
      <td>B</td>
      <td>Casado/a</td>
      <td>57.0</td>
      <td>160.642670</td>
      <td>4320.397345</td>
      <td>1908.324816</td>
      <td>NaN</td>
      <td>129.426792</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2024-01-05</td>
      <td>M</td>
      <td>Cali</td>
      <td>Técnico</td>
      <td>B</td>
      <td>Soltero/a</td>
      <td>67.0</td>
      <td>151.402909</td>
      <td>NaN</td>
      <td>1887.385697</td>
      <td>610.213994</td>
      <td>133.916319</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se muestran las últimas filas del DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fecha</th>
      <th>sexo</th>
      <th>ciudad</th>
      <th>nivel_educativo</th>
      <th>segmento</th>
      <th>estado_civil</th>
      <th>edad</th>
      <th>altura_cm</th>
      <th>ingresos</th>
      <th>gasto_mensual</th>
      <th>puntuacion_credito</th>
      <th>demanda</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>995</th>
      <td>2026-09-22</td>
      <td>M</td>
      <td>Cali</td>
      <td>Universitario</td>
      <td>B</td>
      <td>Divorciado/a</td>
      <td>42.0</td>
      <td>174.029439</td>
      <td>3900.871957</td>
      <td>1726.737261</td>
      <td>NaN</td>
      <td>209.333348</td>
    </tr>
    <tr>
      <th>996</th>
      <td>2026-09-23</td>
      <td>F</td>
      <td>Cali</td>
      <td>NaN</td>
      <td>B</td>
      <td>Soltero/a</td>
      <td>57.0</td>
      <td>172.937551</td>
      <td>3510.958513</td>
      <td>1158.564446</td>
      <td>702.765666</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>997</th>
      <td>2026-09-24</td>
      <td>M</td>
      <td>Bogotá</td>
      <td>Técnico</td>
      <td>NaN</td>
      <td>Casado/a</td>
      <td>69.0</td>
      <td>172.978652</td>
      <td>5835.890293</td>
      <td>NaN</td>
      <td>547.840036</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>998</th>
      <td>2026-09-25</td>
      <td>F</td>
      <td>Bogotá</td>
      <td>Posgrado</td>
      <td>C</td>
      <td>Casado/a</td>
      <td>48.0</td>
      <td>NaN</td>
      <td>3809.637777</td>
      <td>1275.292213</td>
      <td>510.525079</td>
      <td>214.627744</td>
    </tr>
    <tr>
      <th>999</th>
      <td>2026-09-26</td>
      <td>M</td>
      <td>Bogotá</td>
      <td>Universitario</td>
      <td>B</td>
      <td>Soltero/a</td>
      <td>53.0</td>
      <td>174.410385</td>
      <td>3766.247687</td>
      <td>2559.455016</td>
      <td>700.720902</td>
      <td>204.091366</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se emplea el método <code class="docutils literal notranslate"><span class="pre">df.info()</span></code> para evaluar la estructura y calidad inicial del dataset. Este análisis revela información sobre la composición de los datos, incluyendo el número total de registros (filas) y variables (columnas), los tipos de datos asociados a cada campo (como objetos, enteros o valores flotantes), y la cantidad de valores no nulos por columna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 12 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   fecha               1000 non-null   object 
 1   sexo                980 non-null    object 
 2   ciudad              950 non-null    object 
 3   nivel_educativo     900 non-null    object 
 4   segmento            800 non-null    object 
 5   estado_civil        650 non-null    object 
 6   edad                970 non-null    float64
 7   altura_cm           920 non-null    float64
 8   ingresos            880 non-null    float64
 9   gasto_mensual       750 non-null    float64
 10  puntuacion_credito  500 non-null    float64
 11  demanda             850 non-null    float64
dtypes: float64(6), object(6)
memory usage: 93.9+ KB
</pre></div>
</div>
</div>
</div>
<p><strong>Interpretación</strong></p>
<p>Tenemos un conjunto de datos con 1000 registros (filas) y 12 variables (columnas). La calidad de los datos es mixta, con varios problemas de integridad que necesitarían ser abordados antes de cualquier análisis serio.</p>
<ol class="arabic simple">
<li><p>Tamaño del Dataset</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RangeIndex:</span> <span class="pre">1000</span> <span class="pre">entries,</span> <span class="pre">0</span> <span class="pre">to</span> <span class="pre">999</span></code>: El DataFrame tiene 1000 filas, indexadas del 0 al 999.</p></li>
</ul>
</li>
<li><p>Estructura de las Columnas: El <code class="docutils literal notranslate"><span class="pre">Non-Null</span> <span class="pre">Count</span></code> es el número de valores que no están vacíos. La diferencia entre este número y el total de filas (1000) son los valores faltantes (missing values).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fecha</span></code> (1000 non-null): Columna completa, sin datos faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sexo</span></code> (980 non-null): Tiene 20 valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ciudad</span></code> (950 non-null): Tiene 50 valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code> (900 non-null): Tiene 100 valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">segmento</span></code> (800 non-null): Tiene 200 valores faltantes. Es una de las columnas con más datos missing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">estado_civil</span></code> (650 non-null): Tiene 350 valores faltantes. Problema grave de integridad. Más de 1/3 de los datos faltan.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">edad</span></code> (970 non-null): Tiene 30 valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">altura_cm</span></code> (920 non-null): Tiene 80 valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ingresos</span></code> (880 non-null): Tiene 120 valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gasto_mensual</span></code> (750 non-null): Tiene 250 valores faltantes. Problema serio.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">puntuacion_credito</span></code> (500 non-null): Tiene 500 valores faltantes. Problema gravísimo. La mitad de los registros no tienen este dato. Esta columna es prácticamente inutilizable en su estado actual.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">demanda</span></code> (850 non-null): Tiene 150 valores faltantes.</p></li>
</ul>
</li>
<li><p>Tipos de Datos (Dtype)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code> (6 columnas): Las columnas <code class="docutils literal notranslate"><span class="pre">fecha</span></code>, <code class="docutils literal notranslate"><span class="pre">sexo</span></code>, <code class="docutils literal notranslate"><span class="pre">ciudad</span></code>, <code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code>, <code class="docutils literal notranslate"><span class="pre">segmento</span></code> y <code class="docutils literal notranslate"><span class="pre">estado_civil</span></code> son probablemente texto (strings) o variables categóricas. La columna <code class="docutils literal notranslate"><span class="pre">fecha</span></code> está como <code class="docutils literal notranslate"><span class="pre">object</span></code>, lo que significa que Python no la reconoce como una fecha real.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float64</span></code> (6 columnas): Las columnas de <code class="docutils literal notranslate"><span class="pre">edad</span></code> a <code class="docutils literal notranslate"><span class="pre">demanda</span></code> son números decimales. Esto es adecuado para <code class="docutils literal notranslate"><span class="pre">altura_cm</span></code>, <code class="docutils literal notranslate"><span class="pre">ingresos</span></code>, etc. Para <code class="docutils literal notranslate"><span class="pre">edad</span></code>, podría ser más eficiente como entero (<code class="docutils literal notranslate"><span class="pre">int64</span></code>) si todas las edades son números enteros.</p></li>
</ul>
</li>
</ol>
<p>En resumen, la base de datos requiere un significante trabajo de limpieza y preprocesamiento antes de que sea fiable para generar insights o modelos predictivos. La columna <code class="docutils literal notranslate"><span class="pre">puntuacion_credito</span></code> es la que presenta el mayor desafío.</p>
<section id="variables-numericas">
<h3>Variables Númericas<a class="headerlink" href="#variables-numericas" title="Link to this heading">#</a></h3>
<p>Se genera una tabla resumen de las variables númericas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>edad</th>
      <th>altura_cm</th>
      <th>ingresos</th>
      <th>gasto_mensual</th>
      <th>puntuacion_credito</th>
      <th>demanda</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>970.000000</td>
      <td>920.000000</td>
      <td>880.000000</td>
      <td>750.000000</td>
      <td>500.000000</td>
      <td>850.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>42.861856</td>
      <td>167.760096</td>
      <td>3681.294745</td>
      <td>1687.810749</td>
      <td>599.077500</td>
      <td>160.305759</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14.621382</td>
      <td>9.275530</td>
      <td>1079.326096</td>
      <td>582.070174</td>
      <td>79.828186</td>
      <td>25.357794</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.000000</td>
      <td>140.000000</td>
      <td>487.662547</td>
      <td>100.000000</td>
      <td>373.657944</td>
      <td>99.875828</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>30.000000</td>
      <td>161.488768</td>
      <td>2999.416229</td>
      <td>1309.239768</td>
      <td>544.467843</td>
      <td>139.505538</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>43.000000</td>
      <td>167.714614</td>
      <td>3669.620507</td>
      <td>1676.193764</td>
      <td>599.692595</td>
      <td>160.721251</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>55.000000</td>
      <td>173.999069</td>
      <td>4375.093656</td>
      <td>2063.260990</td>
      <td>653.345068</td>
      <td>181.100754</td>
    </tr>
    <tr>
      <th>max</th>
      <td>69.000000</td>
      <td>195.766921</td>
      <td>7016.246936</td>
      <td>3532.593603</td>
      <td>823.539585</td>
      <td>222.093047</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Interpretación</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">edad</span></code></p>
<ul class="simple">
<li><p><strong>Media (42.86) &amp; Mediana (50%: 43.00):</strong> La media y la mediana son casi idénticas. Esto sugiere una distribución <strong>simétrica y bien balanceada</strong> alrededor de los 43 años, sin sesgos pronunciados hacia la juventud o la vejez.</p></li>
<li><p><strong>Desviación Estándar (14.62):</strong> Indica que la mayoría de las edades se encuentran dentro de ±14.6 años de la media. Es una dispersión esperada para una población adulta.</p></li>
<li><p><strong>Rango (18 - 69):</strong> El rango de edades es completamente plausible, desde adultos jóvenes hasta personas cerca de la jubilación.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">altura_cm</span></code></p>
<ul class="simple">
<li><p><strong>Media (167.76 cm) &amp; Mediana (167.71 cm):</strong> Los valores son prácticamente iguales, indicando una distribución simétrica.</p></li>
<li><p><strong>Desviación Estándar (9.28 cm):</strong> La dispersión es relativamente baja, lo que es típico en una medida biológica como la altura.</p></li>
<li><p><strong>Rango (140 - 195.8 cm):</strong> Los valores mínimo y máximo son perfectamente posibles para una población adulta. El mínimo (1.40 m) y el máximo (1.96 m) están dentro de lo esperado a nivel global.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ingresos</span></code></p>
<ul class="simple">
<li><p><strong>Media (3681.29) &amp; Mediana (3669.62):</strong> La media y la mediana son muy cercanas. Esto es una <strong>excelente noticia</strong>, ya que indica que la distribución de ingresos no está severamente sesgada por unos pocos valores extremadamente altos (outliers). Es una distribución bastante normal.</p></li>
<li><p><strong>Desviación Estándar (1079.33):</strong> Hay una variabilidad significativa en los ingresos, lo cual es muy común.</p></li>
<li><p><strong>Rango (487.66 - 7016.25):</strong> El ingreso mínimo es bajo pero plausible, y el máximo es aproximadamente 14 veces mayor, lo que sugiere diferencias socioeconómicas en la muestra.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">gasto_mensual</span></code></p>
<ul class="simple">
<li><p><strong>Media (1687.81) &amp; Mediana (1676.19):</strong> Al igual que con los ingresos, la similitud entre media y mediana sugiere una distribución equilibrada, no distorsionada por gastos extremos.</p></li>
<li><p><strong>Desviación Estándar (582.07):</strong> Muestra una variabilidad considerable en los hábitos de gasto.</p></li>
<li><p><strong>Relación con Ingresos:</strong> Si comparas la media de gasto (1687) con la media de ingresos (3681), el “gasto promedio” ronda el <strong>46% de los “ingresos promedio”</strong>. Esto parece razonable, asumiendo que los ingresos son netos.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">puntuacion_credito</span></code></p>
<ul class="simple">
<li><p><strong>Media (599.08) &amp; Mediana (599.69):</strong> Distribución perfectamente simétrica. Es común que las puntuaciones de crédito se modelen de esta manera.</p></li>
<li><p><strong>Desviación Estándar (79.83):</strong> Proporciona una medida de cuánto varía la solvencia crediticia entre individuos. Un valor de ~80 puntos es una dispersión significativa.</p></li>
<li><p><strong>Rango (373.66 - 823.54):</strong> Abarca desde una puntuación muy pobre (por debajo de 400) hasta una excelente (por encima de 800). Este rango es estándar para muchas escalas de crédito.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">demanda</span></code></p>
<ul class="simple">
<li><p><strong>Media (160.31) &amp; Mediana (160.72):</strong> Otra distribución muy simétrica.</p></li>
<li><p><strong>Desviación Estándar (25.36):</strong> La demanda tiene una dispersión relativa menor comparada con otras variables como ingresos.</p></li>
<li><p><strong>Rango (99.88 - 222.09):</strong> Todos los valores son positivos y el rango es continuo.</p></li>
</ul>
</li>
</ol>
</section>
<section id="variables-categoricas">
<h3>Variables Categóricas<a class="headerlink" href="#variables-categoricas" title="Link to this heading">#</a></h3>
<p>Se genera una tabla resumen de las variables númericas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fecha</th>
      <th>sexo</th>
      <th>ciudad</th>
      <th>nivel_educativo</th>
      <th>segmento</th>
      <th>estado_civil</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000</td>
      <td>980</td>
      <td>950</td>
      <td>900</td>
      <td>800</td>
      <td>650</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>1000</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>top</th>
      <td>2024-01-01</td>
      <td>F</td>
      <td>Bogotá</td>
      <td>Secundaria</td>
      <td>B</td>
      <td>Soltero/a</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>518</td>
      <td>307</td>
      <td>317</td>
      <td>457</td>
      <td>290</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Interpretación</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fecha</span></code></p></li>
</ol>
<ul class="simple">
<li><p><strong>Unique (1000):</strong> <strong>Cada registro tiene una fecha única.</strong> Esto es muy inusual para datos de personas y sugiere que esta columna probablemente representa la <strong>fecha de registro</strong>, <strong>fecha de transacción</strong> o un identificador temporal único para cada entrada, más que una fecha de nacimiento.</p></li>
<li><p><strong>Top (2024-01-01) &amp; Freq (1):</strong> La fecha más común aparece solo una vez, lo que confirma que todas las fechas son únicas.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">sexo</span></code></p></li>
</ol>
<ul class="simple">
<li><p><strong>Unique (2):</strong> Existen solo dos categorías, lo que es esperado.</p></li>
<li><p><strong>Top (F) &amp; Freq (518):</strong> La categoría ‘F’ (Femenino) es la más frecuente, con 518 apariciones. La distribución está bastante balanceada, con una ligera mayoría femenina.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">ciudad</span></code></p></li>
</ol>
<ul class="simple">
<li><p><strong>Unique (5):</strong> Los datos provienen de 5 ciudades diferentes.</p></li>
<li><p><strong>Top (Bogotá) &amp; Freq (307):</strong> Bogotá es la ciudad más representada en el dataset, con 307 registros.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code></p></li>
</ol>
<ul class="simple">
<li><p><strong>Unique (4):</strong> Hay 4 niveles educativos distintos.</p></li>
<li><p><strong>Top (Secundaria) &amp; Freq (317):</strong> El nivel educativo más común es ‘Secundaria’. Esto sugiere que la muestra está compuesta predominantemente por personas con un nivel educativo de media a alta (asumiendo que “Secundaria” es el mínimo).</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p><code class="docutils literal notranslate"><span class="pre">segmento</span></code></p></li>
</ol>
<ul class="simple">
<li><p><strong>Unique (3):</strong> Hay 3 segmentos.</p></li>
<li><p><strong>Top (B) &amp; Freq (457):</strong> El segmento ‘B’ es, con mucha diferencia, el más común. Esto indica una fuerte concentración en este segmento, lo que podría sesgar cualquier análisis si no se tiene en cuenta.</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p><code class="docutils literal notranslate"><span class="pre">estado_civil</span></code></p></li>
</ol>
<ul class="simple">
<li><p><strong>Unique (4):</strong> Hay 4 estados civiles..</p></li>
<li><p><strong>Top (Soltero/a) &amp; Freq (290):</strong> Las personas solteras son el grupo más grande.</p></li>
</ul>
<p>Este análisis es crucial para entender la composición de tu población de estudio y los posibles sesgos que puedan existir en los datos antes de proceder con modelado o inferencia estadística.</p>
<hr class="docutils" />
<p>Se genera una tabla con las frecuencias absolutas y relativas de las variables categóricas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    
    <span class="n">frecuencia_absoluta</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

    <span class="n">frecuencia_relativa</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">tabla_resumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;Frecuencia Absoluta&#39;</span><span class="p">:</span> <span class="n">frecuencia_absoluta</span><span class="p">,</span>
        <span class="s1">&#39;Frecuencia Relativa (%)&#39;</span><span class="p">:</span> <span class="n">frecuencia_relativa</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="p">})</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tabla_resumen</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== FECHA ===
            Frecuencia Absoluta  Frecuencia Relativa (%)
fecha                                                   
2024-01-01                    1                      0.1
2025-11-02                    1                      0.1
2025-10-20                    1                      0.1
2025-10-21                    1                      0.1
2025-10-22                    1                      0.1
...                         ...                      ...
2024-12-04                    1                      0.1
2024-12-05                    1                      0.1
2024-12-06                    1                      0.1
2024-12-07                    1                      0.1
2026-09-26                    1                      0.1

[1000 rows x 2 columns]
--------------------------------------------------

=== SEXO ===
      Frecuencia Absoluta  Frecuencia Relativa (%)
sexo                                              
F                     518                52.857143
M                     462                47.142857
--------------------------------------------------

=== CIUDAD ===
              Frecuencia Absoluta  Frecuencia Relativa (%)
ciudad                                                    
Bogotá                        307                32.315789
Medellín                      192                20.210526
Cali                          189                19.894737
Barranquilla                  161                16.947368
Cartagena                     101                10.631579
--------------------------------------------------

=== NIVEL_EDUCATIVO ===
                 Frecuencia Absoluta  Frecuencia Relativa (%)
nivel_educativo                                              
Secundaria                       317                35.222222
Universitario                    251                27.888889
Técnico                          224                24.888889
Posgrado                         108                12.000000
--------------------------------------------------

=== SEGMENTO ===
          Frecuencia Absoluta  Frecuencia Relativa (%)
segmento                                              
B                         457                   57.125
A                         194                   24.250
C                         149                   18.625
--------------------------------------------------

=== ESTADO_CIVIL ===
              Frecuencia Absoluta  Frecuencia Relativa (%)
estado_civil                                              
Soltero/a                     290                44.615385
Casado/a                      231                35.538462
Unión libre                    93                14.307692
Divorciado/a                   36                 5.538462
--------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p><strong>Interpretación</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eexo</span></code>: El conjunto de datos tiene una distribución casi uniforme de género. Hay <strong>518</strong> personas de sexo femenino (<strong>52.86%</strong>) y <strong>462</strong> personas de sexo masculino (<strong>47.14%</strong>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ciudad</span></code>: La mayoría de los encuestados residen en las ciudades principales de Colombia. <strong>Bogotá</strong> es la ciudad más representada, con <strong>307</strong> observaciones (<strong>32.32%</strong>), seguida por <strong>Medellín</strong> (<strong>20.21%</strong>) y <strong>Cali</strong> (<strong>19.89%</strong>). Barranquilla y Cartagena tienen una menor representación.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nivel</span> <span class="pre">educativo</span></code>: Gran parte de la muestra tiene un nivel educativo de <strong>Secundaria</strong> (<strong>35.22%</strong>), seguido de cerca por <strong>Universitario</strong> (<strong>27.89%</strong>). Los niveles <strong>Técnico</strong> y <strong>Posgrado</strong> son menos comunes, con <strong>24.89%</strong> y <strong>12.00%</strong> respectivamente.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">segmento</span></code>: El <strong>segmento B</strong> es, por mucho, el más grande en el conjunto de datos, representando más de la mitad de la muestra con <strong>457</strong> observaciones (<strong>57.12%</strong>). Los segmentos A y C son significativamente más pequeños, con el <strong>24.25%</strong> y el <strong>18.62%</strong> de la muestra, respectivamente.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">estado</span> <span class="pre">civil</span></code>: Gran parte de las personas en la muestra son <strong>solteras</strong> (<strong>44.62%</strong>). Las personas <strong>casadas</strong> constituyen el segundo grupo más grande (<strong>35.54%</strong>), mientras que la <strong>unión libre</strong> y el <strong>divorcio</strong> representan grupos más pequeños.</p></li>
</ul>
</section>
</section>
<section id="valores-nulos">
<h2>Valores Nulos<a class="headerlink" href="#valores-nulos" title="Link to this heading">#</a></h2>
<p>Para cuantificar la magnitud de datos ausentes en cada columna, se calculó el porcentaje de valores nulos y el conteo de esta manera podemos identificar variables críticas que requieren intervención prioritaria en el proceso de limpieza.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">null_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">null_percent</span> <span class="o">=</span> <span class="p">(</span><span class="n">null_counts</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="n">missing_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Nulos&quot;</span><span class="p">:</span> <span class="n">null_counts</span><span class="p">,</span>
    <span class="s2">&quot;Porcentaje (%)&quot;</span><span class="p">:</span> <span class="n">null_percent</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Resumen de valores nulos ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Resumen de valores nulos ===
                    Nulos  Porcentaje (%)
fecha                   0             0.0
sexo                   20             2.0
ciudad                 50             5.0
nivel_educativo       100            10.0
segmento              200            20.0
estado_civil          350            35.0
edad                   30             3.0
altura_cm              80             8.0
ingresos              120            12.0
gasto_mensual         250            25.0
puntuacion_credito    500            50.0
demanda               150            15.0
</pre></div>
</div>
</div>
</div>
<section id="grafico-de-barras-de-los-valores-nulos">
<h3>Gráfico de Barras de los Valores Nulos<a class="headerlink" href="#grafico-de-barras-de-los-valores-nulos" title="Link to this heading">#</a></h3>
<p>Este gráfico visualiza el porcentaje de datos faltantes en cada variable del dataset, permitiendo identificar de un vistazo las columnas que requieren mayor atención en el proceso de limpieza de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_vars</span> <span class="o">=</span> <span class="n">missing_summary</span><span class="p">[</span><span class="n">missing_summary</span><span class="p">[</span><span class="s2">&quot;Nulos&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">missing_vars</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">missing_vars</span><span class="p">[</span><span class="s2">&quot;Porcentaje (%)&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Porcentaje de Nulos por Variable&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Porcentaje (%)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Variables&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">bars</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">yval</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">yval</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">yval</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/48248798afba6ce5958d602735eeaaabe790555514a3d8f4fd626a55e1ad865f.png" src="_images/48248798afba6ce5958d602735eeaaabe790555514a3d8f4fd626a55e1ad865f.png" />
</div>
</div>
</section>
<section id="mapa-de-calor-de-los-valores-nulos">
<h3>Mapa de Calor de los Valores Nulos<a class="headerlink" href="#mapa-de-calor-de-los-valores-nulos" title="Link to this heading">#</a></h3>
<p>Este mapa de calor ofrece una representación visual inmediata de la distribución y el patrón de los datos faltantes en el conjunto de datos. Cada línea horizontal es un registro y cada columna una variable, permitiendo identificar fácilmente si los valores nulos se concentran en registros específicos o se dispersan aleatoriamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mapa de Calor&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Variables&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Observaciones&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/424d772ccc21492fd96d2abd50fc777a068a0ba10c27ec07df302c7239f8137b.png" src="_images/424d772ccc21492fd96d2abd50fc777a068a0ba10c27ec07df302c7239f8137b.png" />
</div>
</div>
</section>
</section>
<section id="clasificacion-del-tipo-de-dato-faltante-y-discusion-sobre-su-imputabilidad">
<h2>Clasificación del Tipo de Dato Faltante y Discusión sobre su Imputabilidad<a class="headerlink" href="#clasificacion-del-tipo-de-dato-faltante-y-discusion-sobre-su-imputabilidad" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Variables Numéricas</strong></p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">edad</span></code> (3% nulos, MCAR):</strong>
Sí se justifica imputar, ya que el porcentaje es bajo y el riesgo es mínimo. La técnica dependerá de la distribución: se utilizará la <strong>media</strong> si es normal o la <strong>mediana</strong> si no lo es.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">altura_cm</span></code> (8% nulos, MCAR):</strong>
Sí se justifica imputar. Se imputará con el algoritmo <strong>KNN</strong>, aprovechando la similitud entre individuos para generar valores más coherentes con el perfil de cada persona.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ingresos</span></code> (12% nulos, MAR/MNAR):</strong>
Sí se justifica imputar. Se usará un modelo de <strong>regresión</strong>, ya que variables como la edad y el nivel educativo suelen ser predictores directos del nivel de ingresos, por lo que se emplearán como variables independientes en el modelo.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">gasto_mensual</span></code> (25% nulos, MAR):</strong>
Sí se justifica imputar, aunque el porcentaje de nulos es considerable. El riesgo de modificar la distribución original con un método simple es alto, por lo que se optará por el método <strong>KNN</strong> por su robustez.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">puntuacion_credito</span></code> (50% nulos, MNAR):</strong>
<strong>No se recomienda imputar</strong> esta variable. Los valores faltantes parecen corresponder a un patrón MNAR (Missing Not at Random), ya que las personas sin historial crediticio no poseen un valor que pueda estimarse de manera confiable. Una imputación introduciría un sesgo importante en el análisis.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">demanda</span></code> (15% nulos, MAR):</strong>
Sí se justifica imputar. Se utilizará el método <strong>MICE</strong> (Multiple Imputation by Chained Equations), ya que aprovecha la información conjunta de todas las variables y preserva mejor la relación entre la demanda, los ingresos y el gasto mensual, variables que pueden aportar información valiosa para su estimación.</p></li>
</ul>
</li>
<li><p><strong>Variables Cualitativas</strong></p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">sexo</span></code> (2% nulos, MCAR):</strong>
Sí se justifica imputar, dado que la proporción de nulos es baja. Se usará la <strong>moda</strong> (valor más frecuente).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ciudad</span></code> (5% nulos, MCAR):</strong>
Sí se justifica imputar, dado que la proporción de nulos es baja. Se usará la <strong>moda</strong>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code> (10% nulos, MAR):</strong>
Sí se justifica imputar. Se usará el método <strong>hot-deck</strong>, aprovechando la relación con variables como la edad y los ingresos para asignar valores más consistentes y representativos para cada persona.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">segmento</span></code> (20% nulos, MAR):</strong>
Sí se justifica imputar. Se imputará con el método <strong>hot-deck</strong>, ya que esta técnica aprovecha la similitud entre individuos (por ejemplo, según ingresos, gasto mensual, etc.) para asignar valores faltantes.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">estado_civil</span></code> (35% nulos, MNAR):</strong>
<strong>No es recomendable imputar</strong>. Al estar clasificado como MNAR, es probable que la ausencia de datos dependa del valor real no observado (por ejemplo, personas que prefieren no reportar su estado civil). Cualquier imputación introduciría un sesgo fuerte y comprometería la validez de los análisis posteriores.</p></li>
</ul>
</li>
</ul>
</section>
<section id="imputacion-en-variables-numericas">
<h2>Imputación en Variables Númericas<a class="headerlink" href="#imputacion-en-variables-numericas" title="Link to this heading">#</a></h2>
<section id="variable-edad">
<h3>Variable ‘edad’<a class="headerlink" href="#variable-edad" title="Link to this heading">#</a></h3>
<p><strong><code class="docutils literal notranslate"><span class="pre">edad</span></code> (3% nulos, MCAR):</strong> Dado el bajo porcentaje de valores faltantes y su naturaleza aleatoria, se procederá a su imputación. El método se seleccionará en función de la distribución de los datos: se utilizará la <strong>media</strong> si la distribución es normal o la <strong>mediana</strong> en caso contrario. Primero se evaluará el supuesto de normalidad mediante pruebas estadísticas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;edad&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro-Wilk para edad: W=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p-valor=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shapiro-Wilk para edad: W=0.9598, p-valor=0.0000
</pre></div>
</div>
</div>
</div>
<p>Dado que el p-valor es menor que 0.05, se rechaza <span class="math notranslate nohighlight">\(H_0\)</span>, por lo que la variable <code class="docutils literal notranslate"><span class="pre">edad</span></code> no sigue una distribución normal, usaremos la mediana para la imputación.</p>
<hr class="docutils" />
<p>Se realizan los cambios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mediana</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nulos antes:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">mediana_edad</span> <span class="o">=</span> <span class="n">df_mediana</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">df_mediana</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_mediana</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mediana_edad</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nulos después:&quot;</span><span class="p">,</span> <span class="n">df_mediana</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nulos antes: 30
Nulos después: 0
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Se realiza un análisis de la conservación de la distribución Post-Imputación por medio de un histograma y una prueba no parametrica (debido a que la variable <code class="docutils literal notranslate"><span class="pre">edad</span></code> no sigue una distribución normal) para corroborar si luego de hacer la imputación de los datos se mantiene la distribucion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Edad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de &#39;edad&#39; antes de imputación&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_mediana</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Edad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de &#39;edad&#39; después de imputación (mediana)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2b0fa92d75a2dc48dd210c01eed65853e6ab27dbebfb4084ff4f26334161cd96.png" src="_images/2b0fa92d75a2dc48dd210c01eed65853e6ab27dbebfb4084ff4f26334161cd96.png" />
<img alt="_images/8419ade930469b06473376167a4997b011bba641b3131241b3fd6f83675f1c6a.png" src="_images/8419ade930469b06473376167a4997b011bba641b3131241b3fd6f83675f1c6a.png" />
</div>
</div>
<p>Se realiza la prueba no paramétrica para evaluar si la imputación mantuvo la distribución de la variable, se emplea la prueba de <code class="docutils literal notranslate"><span class="pre">Kolmogorov–Smirnov</span></code>, la cual permite comparar estadísticamente dos muestras y determinar si provienen de la misma distribución.</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span>: ambas muestras provienen de la misma distribución.</p>
<p><span class="math notranslate nohighlight">\(H_1\)</span>: las muestras provienen de distribuciones diferentes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ks_2samp</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">df_mediana</span><span class="p">[</span><span class="s1">&#39;edad&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolmogorov-Smirnov: estadístico=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p-valor=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolmogorov-Smirnov: estadístico=0.0148, p-valor=0.9998
</pre></div>
</div>
</div>
</div>
<p>Dado que el p-valor es mayor que el nivel de significancia, no hay evidencia significativa para rechazar <span class="math notranslate nohighlight">\(H_0\)</span>, por lo que ambas muestras provienen de la misma distribución, por lo tanto la imputación no afecto la distribución.</p>
</section>
<section id="variables-altura-cm-y-gasto-mensual">
<h3>Variables ‘altura_cm’ y ‘gasto_mensual’<a class="headerlink" href="#variables-altura-cm-y-gasto-mensual" title="Link to this heading">#</a></h3>
<p>Para las variables <code class="docutils literal notranslate"><span class="pre">altura_cm</span></code> y <code class="docutils literal notranslate"><span class="pre">gasto_mensual</span></code>, cuyos patrones de valores faltantes fueron identificados como aleatorios (MCAR/MAR), se procederá a realizar su imputación utilizando el algoritmo K-Vecinos Más Cercanos (KNN) con k=5 vecinos. Este método permite estimar los valores faltantes basándose en la similitud de otros individuos dentro del dataset, preservando así la estructura inherente de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;altura_cm&quot;</span><span class="p">,</span> <span class="s2">&quot;gasto_mensual&quot;</span><span class="p">]</span>
<span class="n">df_original</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">)</span>
<span class="n">df_knn</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_knn</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_knn</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nulos antes:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nulos después (KNN):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df_knn</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nulos antes:
 altura_cm         80
gasto_mensual    250
dtype: int64

Nulos después (KNN):
 altura_cm        0
gasto_mensual    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Se realiza un análisis de la conservación de la distribución Post-Imputación por medio de histogramas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
   
    <span class="n">base</span> <span class="o">=</span> <span class="n">df_original</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">df_knn</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">base</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">after</span><span class="o">.</span><span class="n">values</span><span class="p">]),</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> - Antes (sin NaN)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">after</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> - Después (KNN)&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograma comparativo: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d5d0a97f193ffed59c16f46db5903087b817f8de25ad2cd4242ff6778e7d5bc2.png" src="_images/d5d0a97f193ffed59c16f46db5903087b817f8de25ad2cd4242ff6778e7d5bc2.png" />
<img alt="_images/0605a5800d939de6b2cae254e8ce644b534286e9d8e84069451085c2c73e9470.png" src="_images/0605a5800d939de6b2cae254e8ce644b534286e9d8e84069451085c2c73e9470.png" />
</div>
</div>
<p>Para evaluar estadísticamente la calidad de la imputación, se compararon las distribuciones de los datos originales y los imputados mediante pruebas de normalidad, igualdad de distribuciones y diferencias entre grupos, calculando además el tamaño del efecto para cada variable numérica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span><span class="p">,</span> <span class="n">ks_2samp</span><span class="p">,</span> <span class="n">ttest_ind</span><span class="p">,</span> <span class="n">mannwhitneyu</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cohens_d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cohen&#39;s d para comparar medias&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">sx2</span><span class="p">,</span> <span class="n">sy2</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sx2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sy2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="k">if</span> <span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">sp</span> <span class="k">if</span> <span class="n">sp</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rank_biserial_from_u</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coeficiente r biserial derivado de U de Mann–Whitney&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Evaluación analítica de imputación&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df_original</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> 
    <span class="n">y</span> <span class="o">=</span> <span class="n">df_knn</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">sh_x</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">sh_y</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">normal_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">sh_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="n">normal_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">sh_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="n">ks</span> <span class="o">=</span> <span class="n">ks_2samp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">normal_x</span> <span class="ow">and</span> <span class="n">normal_y</span><span class="p">:</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">eff</span> <span class="o">=</span> <span class="n">cohens_d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;t de Student (Welch)&quot;</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">eff_name</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s2">&quot;Cohen d&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
        <span class="n">eff</span> <span class="o">=</span> <span class="n">rank_biserial_from_u</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;Mann–Whitney U&quot;</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">eff_name</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s2">&quot;r biserial&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sh_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sh_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro original: W=</span><span class="si">{</span><span class="n">sh_x</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39;Normal&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normal_x</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No normal&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro KNN     : W=</span><span class="si">{</span><span class="n">sh_y</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39;Normal&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normal_y</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No normal&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KS (orig vs KNN): D=</span><span class="si">{</span><span class="n">ks</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Distribuciones iguales&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="o">&gt;</span><span class="n">alpha</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Distribuciones diferentes&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_name</span><span class="si">}</span><span class="s2">: stat=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Sin diferencia&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">p</span><span class="o">&gt;</span><span class="n">alpha</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Diferencia significativa&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamaño de efecto (</span><span class="si">{</span><span class="n">eff_name</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">eff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
        <span class="s2">&quot;Shapiro_orig_p&quot;</span><span class="p">:</span> <span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">if</span> <span class="n">sh_x</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
        <span class="s2">&quot;Shapiro_knn_p&quot;</span><span class="p">:</span> <span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">if</span> <span class="n">sh_y</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
        <span class="s2">&quot;KS_p&quot;</span><span class="p">:</span> <span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test_name</span><span class="p">,</span>
        <span class="s2">&quot;p_media_rangos&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
        <span class="s2">&quot;effect_metric&quot;</span><span class="p">:</span> <span class="n">eff_name</span><span class="p">,</span>
        <span class="s2">&quot;effect_size&quot;</span><span class="p">:</span> <span class="n">eff</span>
    <span class="p">})</span>

<span class="n">df_resumen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Evaluación analítica de imputación

--- altura_cm ---
Shapiro original: W=0.998, p=0.5915 -&gt; Normal
Shapiro KNN     : W=0.998, p=0.3030 -&gt; Normal
KS (orig vs KNN): D=0.019, p=0.9944 -&gt; Distribuciones iguales
t de Student (Welch): stat=0.001, p=0.9991 -&gt; Sin diferencia
Tamaño de efecto (Cohen d) = 0.000

--- gasto_mensual ---
Shapiro original: W=0.998, p=0.6746 -&gt; Normal
Shapiro KNN     : W=0.995, p=0.0029 -&gt; No normal
KS (orig vs KNN): D=0.044, p=0.3595 -&gt; Distribuciones iguales
Mann–Whitney U: stat=371129.000, p=0.7114 -&gt; Sin diferencia
Tamaño de efecto (r biserial) = 0.010
</pre></div>
</div>
</div>
</div>
<p>La imputación KNN ha sido <strong>altamente efectiva</strong> para ambas variables, sin introducir sesgos significativos en la estructura general de los datos.</p>
<p><strong>Para <code class="docutils literal notranslate"><span class="pre">altura_cm</span></code>:</strong></p>
<ul class="simple">
<li><p><strong>Imputación perfecta:</strong> Los datos originales e imputados son normales (Shapiro p &gt; 0.05) y sus distribuciones son estadísticamente indistinguibles (KS p=0.9944). No hay diferencia significativa entre las medias (t-test p=0.9991) y el tamaño del efecto es irrelevante (Cohen d=0.000). La imputación preservó perfectamente todas las propiedades estadísticas.</p></li>
</ul>
<p><strong>Para <code class="docutils literal notranslate"><span class="pre">gasto_mensual</span></code>:</strong></p>
<ul class="simple">
<li><p><strong>Imputación exitosa con un pequeño efecto:</strong> Aunque el conjunto imputado no es normal (Shapiro p=0.0029), la distribución global se mantiene igual a la original (KS p=0.3595). No hay diferencias significativas en las medianas (Mann-Whitney p=0.7114) y el tamaño del efecto es negligible (r=0.010). La imputación fue robusta y no alteró la distribución subyacente.</p></li>
</ul>
</section>
<section id="variable-ingreso">
<h3>Variable ‘ingreso’<a class="headerlink" href="#variable-ingreso" title="Link to this heading">#</a></h3>
<p>Para la variable <strong><code class="docutils literal notranslate"><span class="pre">ingresos</span></code></strong>, que presenta un 12% de valores faltantes con un patrón clasificado como MAR/MNAR, se procederá a realizar la imputación mediante un <strong>modelo de regresión múltiple</strong>. Este método permitirá estimar los valores missing utilizando como predictores variables correlacionadas como la edad y el nivel educativo, garantizando así una estimación contextualmente coherente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orig</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_reg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df_reg</span><span class="p">[[</span><span class="s2">&quot;edad&quot;</span><span class="p">,</span> <span class="s2">&quot;nivel_educativo&quot;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_reg</span><span class="p">[</span><span class="s2">&quot;ingresos&quot;</span><span class="p">]</span>

<span class="n">imp_num</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">imp_cat</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;most_frequent&quot;</span><span class="p">)</span>

<span class="n">X_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imp_num</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="s2">&quot;edad&quot;</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;edad&quot;</span><span class="p">])</span>
<span class="n">X_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imp_cat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="s2">&quot;nivel_educativo&quot;</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nivel_educativo&quot;</span><span class="p">])</span>

<span class="n">X_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_cat</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">X_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_num</span><span class="p">,</span> <span class="n">X_cat</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mask_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">mask_pred</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_clean</span><span class="p">[</span><span class="n">mask_train</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">mask_train</span><span class="p">])</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_clean</span><span class="p">[</span><span class="n">mask_pred</span><span class="p">])</span>
<span class="n">df_reg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask_pred</span><span class="p">,</span> <span class="s2">&quot;ingresos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>

<span class="n">nulos_antes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ingresos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nulos_despues</span> <span class="o">=</span> <span class="n">df_reg</span><span class="p">[</span><span class="s2">&quot;ingresos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;ingresos&#39; ANTES imputar: </span><span class="si">{</span><span class="n">nulos_antes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;ingresos&#39; DESPUÉS imputar: </span><span class="si">{</span><span class="n">nulos_despues</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nulos en &#39;ingresos&#39; ANTES imputar: 120
Nulos en &#39;ingresos&#39; DESPUÉS imputar: 0
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Se realiza un análisis de la conservación de la distribución Post-Imputación por medio de histogramas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">[</span><span class="s2">&quot;ingresos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">after</span> <span class="o">=</span> <span class="n">df_reg</span><span class="p">[</span><span class="s2">&quot;ingresos&quot;</span><span class="p">]</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">base</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">after</span><span class="o">.</span><span class="n">values</span><span class="p">]),</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ingresos - Antes (sin NaN)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">after</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ingresos - Después (Regresión)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Histograma comparativo: ingresos&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/883d6cafd548728c4d2609c85436f32d3312c1edcd837a614ca2ec3cea0ca377.png" src="_images/883d6cafd548728c4d2609c85436f32d3312c1edcd837a614ca2ec3cea0ca377.png" />
</div>
</div>
<p>Para evaluar estadísticamente la calidad de la imputación, se compararon las distribuciones de los datos originales y los imputados mediante pruebas de normalidad, igualdad de distribuciones y diferencias entre grupos, calculando además el tamaño del efecto para la variable numérica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span><span class="p">,</span> <span class="n">ks_2samp</span><span class="p">,</span> <span class="n">ttest_ind</span><span class="p">,</span> <span class="n">mannwhitneyu</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cohens_d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cohen&#39;s d para comparar medias&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">sx2</span><span class="p">,</span> <span class="n">sy2</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sx2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sy2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="k">if</span> <span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">sp</span> <span class="k">if</span> <span class="n">sp</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rank_biserial_from_u</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coeficiente r biserial derivado de U de Mann–Whitney&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Evaluación analítica de imputación&quot;</span><span class="p">)</span>

<span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;ingresos&quot;</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_reg</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">sh_x</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">sh_y</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">normal_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">sh_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">normal_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">sh_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">ks</span> <span class="o">=</span> <span class="n">ks_2samp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">if</span> <span class="n">normal_x</span> <span class="ow">and</span> <span class="n">normal_y</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">eff</span> <span class="o">=</span> <span class="n">cohens_d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;t de Student (Welch)&quot;</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">eff_name</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s2">&quot;Cohen d&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
    <span class="n">eff</span> <span class="o">=</span> <span class="n">rank_biserial_from_u</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;Mann–Whitney U&quot;</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">eff_name</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s2">&quot;r biserial&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">sh_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sh_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro original : W=</span><span class="si">{</span><span class="n">sh_x</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39;Normal&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normal_x</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No normal&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro imputado : W=</span><span class="si">{</span><span class="n">sh_y</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39;Normal&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normal_y</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No normal&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KS (orig vs imputado): D=</span><span class="si">{</span><span class="n">ks</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Distribuciones iguales&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="o">&gt;</span><span class="n">alpha</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Distribuciones diferentes&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_name</span><span class="si">}</span><span class="s2">: stat=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Sin diferencia&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">p</span><span class="o">&gt;</span><span class="n">alpha</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Diferencia significativa&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamaño de efecto (</span><span class="si">{</span><span class="n">eff_name</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">eff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
    <span class="s2">&quot;Shapiro_orig_p&quot;</span><span class="p">:</span> <span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">if</span> <span class="n">sh_x</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;Shapiro_imput_p&quot;</span><span class="p">:</span> <span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">if</span> <span class="n">sh_y</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;KS_p&quot;</span><span class="p">:</span> <span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test_name</span><span class="p">,</span>
    <span class="s2">&quot;p_media_rangos&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
    <span class="s2">&quot;effect_metric&quot;</span><span class="p">:</span> <span class="n">eff_name</span><span class="p">,</span>
    <span class="s2">&quot;effect_size&quot;</span><span class="p">:</span> <span class="n">eff</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Evaluación analítica de imputación

--- ingresos ---
Shapiro original : W=0.998, p=0.3244 -&gt; Normal
Shapiro imputado : W=0.997, p=0.0665 -&gt; Normal
KS (orig vs imputado): D=0.019, p=0.9959 -&gt; Distribuciones iguales
t de Student (Welch): stat=0.237, p=0.8127 -&gt; Sin diferencia
Tamaño de efecto (Cohen d) = 0.011
</pre></div>
</div>
</div>
</div>
<p>La imputación mediante regresión para la variable <strong><code class="docutils literal notranslate"><span class="pre">ingresos</span></code></strong> fue <strong>altamente exitosa y preservó integralmente las propiedades estadísticas</strong> de los datos originales.</p>
<ol class="arabic simple">
<li><p><strong>Normalidad conservada:</strong> Tanto los datos originales como los imputados mantienen una distribución normal (Shapiro p &gt; 0.05), lo que valida el uso de métodos paramétricos para su evaluación.</p></li>
<li><p><strong>Distribución idéntica:</strong> La prueba de Kolmogórov-Smirnov (KS) confirma que las distribuciones original e imputada son estadísticamente indistinguibles (D=0.019, p=0.9959).</p></li>
<li><p><strong>Sin diferencias significativas:</strong> No existe evidencia de discrepancia entre las medias de ambos grupos (t-test: p=0.8127).</p></li>
<li><p><strong>Efecto negligible:</strong> El tamaño del efecto (Cohen d=0.011) es insignificante, indicando que la imputación no introdujo sesgos relevantes.</p></li>
</ol>
<p>El modelo de regresión logró imputar los valores faltantes de manera coherente con la estructura original de los datos, garantizando la integridad estadística de la variable para análisis posteriores.</p>
</section>
<section id="variable-demanda">
<h3>Variable ‘demanda’<a class="headerlink" href="#variable-demanda" title="Link to this heading">#</a></h3>
<p>Para la variable <strong><code class="docutils literal notranslate"><span class="pre">demanda</span></code></strong>, que presenta un 15% de valores faltantes con un patrón clasificado como MAR (Missing at Random), se implementará la imputación mediante el método <strong>MICE (Multiple Imputation by Chained Equations)</strong>. Esta técnica avanzada permite modelar y estimar los valores faltantes de forma iterativa, utilizando la información conjunta de todas las variables del dataset, lo que preserva las relaciones multivariadas y la variabilidad inherente de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.experimental</span><span class="w"> </span><span class="kn">import</span> <span class="n">enable_iterative_imputer</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">IterativeImputer</span>

<span class="n">df_orig</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;edad&quot;</span><span class="p">,</span> <span class="s2">&quot;ingresos&quot;</span><span class="p">,</span> <span class="s2">&quot;gasto_mensual&quot;</span><span class="p">,</span> <span class="s2">&quot;puntuacion_credito&quot;</span><span class="p">,</span> <span class="s2">&quot;demanda&quot;</span><span class="p">]</span>

<span class="n">mice</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">df_temp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_temp</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_temp</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>

<span class="n">df_mice</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_mice</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_temp</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span>

<span class="n">nulos_antes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct_antes</span> <span class="o">=</span> <span class="p">(</span><span class="n">nulos_antes</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">nulos_despues</span> <span class="o">=</span> <span class="n">df_mice</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct_despues</span> <span class="o">=</span> <span class="p">(</span><span class="n">nulos_despues</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_mice</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;demanda&#39; ANTES de imputar: </span><span class="si">{</span><span class="n">nulos_antes</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pct_antes</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;demanda&#39; DESPUÉS de imputar: </span><span class="si">{</span><span class="n">nulos_despues</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pct_despues</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nulos en &#39;demanda&#39; ANTES de imputar: 150 (15.00%)
Nulos en &#39;demanda&#39; DESPUÉS de imputar: 0 (0.00%)
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Se realiza un análisis de la conservación de la distribución Post-Imputación por medio de histogramas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">after</span> <span class="o">=</span> <span class="n">df_mice</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">base</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">after</span><span class="o">.</span><span class="n">values</span><span class="p">]),</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;demanda - Antes (con NaN)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">after</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;demanda - Después (MICE)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Histograma comparativo: demanda&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/28ad8e23131869b977eef78890ed37cb7c8444902c5996239a0eeb018077032e.png" src="_images/28ad8e23131869b977eef78890ed37cb7c8444902c5996239a0eeb018077032e.png" />
</div>
</div>
<p>Para evaluar estadísticamente la calidad de la imputación, se compararon las distribuciones de los datos originales y los imputados mediante pruebas de normalidad, igualdad de distribuciones y diferencias entre grupos, calculando además el tamaño del efecto para la variable numérica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span><span class="p">,</span> <span class="n">ks_2samp</span><span class="p">,</span> <span class="n">ttest_ind</span><span class="p">,</span> <span class="n">mannwhitneyu</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cohens_d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cohen&#39;s d para comparar medias&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">sx2</span><span class="p">,</span> <span class="n">sy2</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sx2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sy2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="k">if</span> <span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">sp</span> <span class="k">if</span> <span class="n">sp</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rank_biserial_from_u</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coeficiente r biserial derivado de U de Mann–Whitney&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Evaluación analítica de imputación&quot;</span><span class="p">)</span>

<span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;demanda&quot;</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df_orig</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_mice</span><span class="p">[</span><span class="s2">&quot;demanda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


<span class="n">sh_x</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">sh_y</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">normal_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">sh_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">normal_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">sh_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">ks</span> <span class="o">=</span> <span class="n">ks_2samp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">if</span> <span class="n">normal_x</span> <span class="ow">and</span> <span class="n">normal_y</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">eff</span> <span class="o">=</span> <span class="n">cohens_d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;t de Student (Welch)&quot;</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">eff_name</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s2">&quot;Cohen d&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
    <span class="n">eff</span> <span class="o">=</span> <span class="n">rank_biserial_from_u</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;Mann–Whitney U&quot;</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">eff_name</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s2">&quot;r biserial&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">sh_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sh_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro original : W=</span><span class="si">{</span><span class="n">sh_x</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39;Normal&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normal_x</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No normal&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro imputado : W=</span><span class="si">{</span><span class="n">sh_y</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39;Normal&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normal_y</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No normal&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KS (orig vs imputado): D=</span><span class="si">{</span><span class="n">ks</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Distribuciones iguales&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="o">&gt;</span><span class="n">alpha</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Distribuciones diferentes&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">test_name</span><span class="si">}</span><span class="s2">: stat=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Sin diferencia&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">p</span><span class="o">&gt;</span><span class="n">alpha</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Diferencia significativa&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tamaño de efecto (</span><span class="si">{</span><span class="n">eff_name</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">eff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
    <span class="s2">&quot;Shapiro_orig_p&quot;</span><span class="p">:</span> <span class="n">sh_x</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">if</span> <span class="n">sh_x</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;Shapiro_imput_p&quot;</span><span class="p">:</span> <span class="n">sh_y</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">if</span> <span class="n">sh_y</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;KS_p&quot;</span><span class="p">:</span> <span class="n">ks</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test_name</span><span class="p">,</span>
    <span class="s2">&quot;p_media_rangos&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
    <span class="s2">&quot;effect_metric&quot;</span><span class="p">:</span> <span class="n">eff_name</span><span class="p">,</span>
    <span class="s2">&quot;effect_size&quot;</span><span class="p">:</span> <span class="n">eff</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Evaluación analítica de imputación

--- demanda ---
Shapiro original : W=0.985, p=0.0000 -&gt; No normal
Shapiro imputado : W=0.989, p=0.0000 -&gt; No normal
KS (orig vs imputado): D=0.074, p=0.0127 -&gt; Distribuciones diferentes
Mann–Whitney U: stat=425542.000, p=0.9623 -&gt; Sin diferencia
Tamaño de efecto (r biserial) = -0.001
</pre></div>
</div>
</div>
</div>
<p>La imputación mediante <strong>MICE</strong> para la variable <strong><code class="docutils literal notranslate"><span class="pre">demanda</span></code></strong> produjo resultados <strong>aceptables pero con un efecto leve en la distribución global</strong>, manteniendo la tendencia central de los datos.</p>
<ol class="arabic simple">
<li><p><strong>Consistencia en la no normalidad:</strong> Tanto los datos originales como los imputados siguen una distribución no normal (Shapiro p &lt; 0.05), lo cual es coherente con la naturaleza de la variable.</p></li>
<li><p><strong>Diferencia distribucional leve:</strong> La prueba KS detecta una diferencia significativa entre las distribuciones (D=0.074, p=0.0127), lo que sugiere que la imputación alteró ligeramente la forma de la distribución.</p></li>
<li><p><strong>Tendencia central preservada:</strong> No hay diferencias significativas en las medianas (Mann-Whitney p=0.9623), indicando que la imputación mantuvo la ubicación central de los datos.</p></li>
<li><p><strong>Efecto prácticamente nulo:</strong> El tamaño del efecto es negligible (r bisarial = -0.001), confirmando que la diferencia práctica es irrelevante.</p></li>
</ol>
<p>El método MICE logró imputar los valores faltantes preservando la tendencia central y sin introducir sesgos relevantes, aunque se detectó una leve modificación en la forma de la distribución. Los resultados son válidos para análisis posteriores.</p>
</section>
</section>
<section id="imputacion-en-variables-categoricas">
<h2>Imputación en Variables Categóricas<a class="headerlink" href="#imputacion-en-variables-categoricas" title="Link to this heading">#</a></h2>
<section id="variables-sexo-y-ciudad">
<h3>Variables ‘sexo’ y ‘ciudad’<a class="headerlink" href="#variables-sexo-y-ciudad" title="Link to this heading">#</a></h3>
<p>Para las variables categóricas <strong><code class="docutils literal notranslate"><span class="pre">sexo</span></code></strong> (2% nulos, MCAR) y <strong><code class="docutils literal notranslate"><span class="pre">ciudad</span></code></strong> (5% nulos, MCAR), se realizará una imputación utilizando la <strong>moda</strong> (valor más frecuente). Este método es adecuado dado el bajo porcentaje de valores faltantes y la naturaleza aleatoria de su ausencia, lo que garantiza que la imputación no introducirá sesgos significativos en la distribución de las categorías.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="n">df_moda</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">variables_a_imputar</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sexo&quot;</span><span class="p">,</span> <span class="s2">&quot;ciudad&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_a_imputar</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Procesando la variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">nulos_antes</span> <span class="o">=</span> <span class="n">df_moda</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; ANTES de imputar: </span><span class="si">{</span><span class="n">nulos_antes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)</span>
    <span class="n">imputed_array</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_moda</span><span class="p">[[</span><span class="n">var</span><span class="p">]])</span>
    <span class="n">df_moda</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputed_array</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="n">nulos_despues</span> <span class="o">=</span> <span class="n">df_moda</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; DESPUÉS de imputar: </span><span class="si">{</span><span class="n">nulos_despues</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando la variable: sexo
==============================
Nulos en &#39;sexo&#39; ANTES de imputar: 20
Nulos en &#39;sexo&#39; DESPUÉS de imputar: 0

Procesando la variable: ciudad
==============================
Nulos en &#39;ciudad&#39; ANTES de imputar: 50
Nulos en &#39;ciudad&#39; DESPUÉS de imputar: 0
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Se realiza un análisis de la conservación de la distribución Post-Imputación por medio de diagramas de barras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2_contingency</span>

<span class="n">variables_a_imputar</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sexo&quot;</span><span class="p">,</span> <span class="s2">&quot;ciudad&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_a_imputar</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Análisis para la variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; - Antes de Imputar&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_moda</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;muted&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; - Después de Imputar (Moda)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Comparación de Distribución de &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">orig_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="n">imp_counts</span> <span class="o">=</span> <span class="n">df_moda</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    
    <span class="n">orig_counts</span> <span class="o">=</span> <span class="n">orig_counts</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">orig_counts</span><span class="p">,</span> <span class="n">imp_counts</span> <span class="o">=</span> <span class="n">orig_counts</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">imp_counts</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;original&quot;</span><span class="p">:</span> <span class="n">orig_counts</span><span class="p">,</span> <span class="s2">&quot;imputada&quot;</span><span class="p">:</span> <span class="n">imp_counts</span><span class="p">})</span><span class="o">.</span><span class="n">T</span>

    <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">tabla</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== Análisis de la Imputación para &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Proporciones originales:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">orig_counts</span> <span class="o">/</span> <span class="n">orig_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Proporciones imputadas:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">imp_counts</span> <span class="o">/</span> <span class="n">imp_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi2 = </span><span class="si">{</span><span class="n">chi2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, gl = </span><span class="si">{</span><span class="n">dof</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> → &quot;</span><span class="p">,</span>
          <span class="s2">&quot;No se rechaza H0 (distribuciones iguales)&quot;</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s2">&quot;Se rechaza H0 (distribuciones diferentes)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para la variable: sexo
==============================
</pre></div>
</div>
<img alt="_images/e6b5fd8e94b55679d1c75f9dd13a4a2ff87180a0df8d09df6c3af88bcf9d5dd5.png" src="_images/e6b5fd8e94b55679d1c75f9dd13a4a2ff87180a0df8d09df6c3af88bcf9d5dd5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Análisis de la Imputación para &#39;sexo&#39; ===
Proporciones originales:
 sexo
F    0.529
M    0.471
Name: count, dtype: float64
Proporciones imputadas:
 sexo
F    0.538
M    0.462
Name: count, dtype: float64
Chi2 = 0.141, gl = 1, p = 0.7074 →  No se rechaza H0 (distribuciones iguales)
------------------------------------------------------------

Análisis para la variable: ciudad
==============================
</pre></div>
</div>
<img alt="_images/153e04b1de090cfecbf091d1304b8dc3f48add5f7563c3bd3d9a626e972d7f73.png" src="_images/153e04b1de090cfecbf091d1304b8dc3f48add5f7563c3bd3d9a626e972d7f73.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Análisis de la Imputación para &#39;ciudad&#39; ===
Proporciones originales:
 ciudad
Barranquilla    0.169
Bogotá          0.323
Cali            0.199
Cartagena       0.106
Medellín        0.202
Name: count, dtype: float64
Proporciones imputadas:
 ciudad
Barranquilla    0.161
Bogotá          0.357
Cali            0.189
Cartagena       0.101
Medellín        0.192
Name: count, dtype: float64
Chi2 = 2.485, gl = 4, p = 0.6474 →  No se rechaza H0 (distribuciones iguales)
------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>La imputación por <strong>moda</strong> aplicada a las variables <code class="docutils literal notranslate"><span class="pre">sexo</span></code> y <code class="docutils literal notranslate"><span class="pre">ciudad</span></code> fue <strong>exitosa y no alteró significativamente la distribución original</strong> de las categorías.</p>
<ol class="arabic simple">
<li><p><strong>Para <code class="docutils literal notranslate"><span class="pre">sexo</span></code>:</strong></p>
<ul class="simple">
<li><p>Las proporciones originales (F: 52.9%, M: 47.1%) se mantuvieron prácticamente iguales tras la imputación (F: 53.8%, M: 46.2%).</p></li>
<li><p>La prueba chi-cuadrado confirma que no hay diferencias significativas (p=0.7074).</p></li>
</ul>
</li>
<li><p><strong>Para <code class="docutils literal notranslate"><span class="pre">ciudad</span></code>:</strong></p>
<ul class="simple">
<li><p>La distribución de ciudades se preservó de manera casi idéntica, con cambios mínimos en las proporciones (ej: Bogotá pasó de 32.3% a 35.7%).</p></li>
<li><p>La prueba chi-cuadrado valida que las distribuciones son estadísticamente iguales (p=0.6474).</p></li>
</ul>
</li>
</ol>
<p>La imputación por moda demostró ser un método <strong>confiable y conservador</strong> para variables categóricas con patrones MCAR, ya que mantuvo la estructura original de los datos sin introducir sesgos relevantes. Los cambios observados son mínimos y estadísticamente insignificantes.</p>
</section>
<section id="variables-nivel-educativo-y-segmento">
<h3>Variables ‘nivel_educativo’ y ‘segmento’<a class="headerlink" href="#variables-nivel-educativo-y-segmento" title="Link to this heading">#</a></h3>
<p>“Para las variables categóricas <strong><code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code></strong> (10% nulos, MAR) y <strong><code class="docutils literal notranslate"><span class="pre">segmento</span></code></strong> (20% nulos, MAR), se implementará la imputación mediante el método <strong>Hot-Deck</strong>. Esta técnica asigna los valores faltantes basándose en la similitud con otros registros completos que comparten características relevantes (como edad, ingresos o ciudad), lo que permite preservar las relaciones multivariadas y generar imputaciones contextualmente coherentes con el perfil de cada individuo.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="n">df_imputado_final</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hot_deck_group</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">sub</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">pool</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="n">variables_a_imputar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;nivel_educativo&quot;</span><span class="p">:</span> <span class="s2">&quot;edad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;segmento&quot;</span><span class="p">:</span> <span class="s2">&quot;nivel_educativo&quot;</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">variables_a_imputar</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Procesando la variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

    <span class="n">nulos_antes</span> <span class="o">=</span> <span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; ANTES de hot-deck: </span><span class="si">{</span><span class="n">nulos_antes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">hot_deck_group</span><span class="p">(</span><span class="n">df_imputado_final</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>

    <span class="n">nulos_despues</span> <span class="o">=</span> <span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">nulos_despues</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">imputer_final</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)</span>
        <span class="n">imputed_array</span> <span class="o">=</span> <span class="n">imputer_final</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_imputado_final</span><span class="p">[[</span><span class="n">var</span><span class="p">]])</span>
        <span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputed_array</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">nulos_final</span> <span class="o">=</span> <span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; FINAL: </span><span class="si">{</span><span class="n">nulos_final</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nulos en &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; DESPUÉS de hot-deck: </span><span class="si">{</span><span class="n">nulos_despues</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando la variable: nivel_educativo
==================================================
Nulos en &#39;nivel_educativo&#39; ANTES de hot-deck: 100
Nulos en &#39;nivel_educativo&#39; FINAL: 0

Procesando la variable: segmento
==================================================
Nulos en &#39;segmento&#39; ANTES de hot-deck: 200
Nulos en &#39;segmento&#39; DESPUÉS de hot-deck: 0
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Se realiza un análisis de la conservación de la distribución Post-Imputación por medio de diagramas de barras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2_contingency</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cramers_v</span><span class="p">(</span><span class="n">ct</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calcula el Coeficiente de Cramér&#39;s V para tablas de contingencia.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chi2</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">correction</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chi2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">k</span><span class="p">))</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">variables_a_analizar</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nivel_educativo&quot;</span><span class="p">,</span> <span class="s2">&quot;segmento&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_a_analizar</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Análisis para la variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; - Antes de Imputar&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;muted&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; - Después de Imputar (Hot-deck)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Comparación de Distribución de &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">orig_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="n">imp_counts</span> <span class="o">=</span> <span class="n">df_imputado_final</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="n">orig_counts</span> <span class="o">=</span> <span class="n">orig_counts</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">orig_counts</span><span class="p">,</span> <span class="n">imp_counts</span> <span class="o">=</span> <span class="n">orig_counts</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">imp_counts</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;original&quot;</span><span class="p">:</span> <span class="n">orig_counts</span><span class="p">,</span> <span class="s2">&quot;imputada&quot;</span><span class="p">:</span> <span class="n">imp_counts</span><span class="p">})</span><span class="o">.</span><span class="n">T</span>

    <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">cramers_v</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== Análisis de Imputación para &#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&#39; ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Proporciones antes:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">orig_counts</span> <span class="o">/</span> <span class="n">orig_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Proporciones después:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">imp_counts</span> <span class="o">/</span> <span class="n">imp_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi2 = </span><span class="si">{</span><span class="n">chi2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, gl = </span><span class="si">{</span><span class="n">dof</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> → &quot;</span><span class="p">,</span>
          <span class="s2">&quot;No se rechaza H0 (distribuciones iguales)&quot;</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s2">&quot;Se rechaza H0 (distribuciones diferentes)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cramér&#39;s V = </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (≈0: muy similar; 0.1: pequeño; 0.3: mediano; 0.5: grande)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Análisis para la variable: nivel_educativo
==================================================
</pre></div>
</div>
<img alt="_images/15a5cfd2b352aec73bdc281d7d2c21283c96405164450ffcac6d2a0f46fb224a.png" src="_images/15a5cfd2b352aec73bdc281d7d2c21283c96405164450ffcac6d2a0f46fb224a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Análisis de Imputación para &#39;nivel_educativo&#39; ===
Proporciones antes:
 nivel_educativo
Posgrado         0.120
Secundaria       0.352
Técnico          0.249
Universitario    0.279
Name: count, dtype: float64
Proporciones después:
 nivel_educativo
Posgrado         0.122
Secundaria       0.355
Técnico          0.241
Universitario    0.282
Name: count, dtype: float64
Chi2 = 0.163, gl = 3, p = 0.9834 →  No se rechaza H0 (distribuciones iguales)
Cramér&#39;s V = 0.009 (≈0: muy similar; 0.1: pequeño; 0.3: mediano; 0.5: grande)
------------------------------------------------------------

Análisis para la variable: segmento
==================================================
</pre></div>
</div>
<img alt="_images/b1ef7f2c7318898736aeb197a86e37b22c93901633ffd9c750d515a939a5e306.png" src="_images/b1ef7f2c7318898736aeb197a86e37b22c93901633ffd9c750d515a939a5e306.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Análisis de Imputación para &#39;segmento&#39; ===
Proporciones antes:
 segmento
A    0.242
B    0.571
C    0.186
Name: count, dtype: float64
Proporciones después:
 segmento
A    0.240
B    0.578
C    0.182
Name: count, dtype: float64
Chi2 = 0.090, gl = 2, p = 0.9558 →  No se rechaza H0 (distribuciones iguales)
Cramér&#39;s V = 0.007 (≈0: muy similar; 0.1: pequeño; 0.3: mediano; 0.5: grande)
------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>La imputación mediante <strong>Hot-Deck</strong> para las variables <code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code> y <code class="docutils literal notranslate"><span class="pre">segmento</span></code> fue <strong>altamente exitosa</strong>, preservando la distribución original de categorías sin introducir sesgos significativos.</p>
<ol class="arabic simple">
<li><p><strong>Para <code class="docutils literal notranslate"><span class="pre">nivel_educativo</span></code>:</strong></p>
<ul class="simple">
<li><p>Las proporciones se mantuvieron prácticamente idénticas (ej: Secundaria 35.2% → 35.5%).</p></li>
<li><p>La prueba chi-cuadrado confirma que no hay diferencias significativas (p=0.9834).</p></li>
<li><p>El tamaño del efecto es negligible (Cramér’s V=0.009).</p></li>
</ul>
</li>
<li><p><strong>Para <code class="docutils literal notranslate"><span class="pre">segmento</span></code>:</strong></p>
<ul class="simple">
<li><p>La distribución se conservó con cambios mínimos (ej: Segmento B 57.1% → 57.8%).</p></li>
<li><p>No se detectaron diferencias estadísticas (p=0.9558).</p></li>
<li><p>El efecto es irrelevante (Cramér’s V=0.007).</p></li>
</ul>
</li>
</ol>
<p>El método Hot-Deck demostró ser <strong>óptimo para variables categóricas con patrones MAR</strong>, ya que asignó valores faltantes de manera coherente con la estructura original de los datos, manteniendo las proporciones y relaciones subyacentes. Los resultados validan la efectividad de la imputación.</p>
</section>
</section>
<section id="tabla-resumen">
<h2>Tabla Resumen<a class="headerlink" href="#tabla-resumen" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Variable</p></th>
<th class="head text-left"><p>% Nulos</p></th>
<th class="head text-left"><p>Tipo Ausencia</p></th>
<th class="head text-left"><p>Método Imputación</p></th>
<th class="head text-left"><p>Evidencia Estadística</p></th>
<th class="head text-left"><p>Tamaño Efecto</p></th>
<th class="head text-left"><p>Conclusión</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><strong>sexo</strong></p></td>
<td class="text-left"><p>2%</p></td>
<td class="text-left"><p>MCAR</p></td>
<td class="text-left"><p>Moda</p></td>
<td class="text-left"><p>Chi-cuadrado: p=0.7074</p></td>
<td class="text-left"><p>Cramér’s V: 0.009</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>ciudad</strong></p></td>
<td class="text-left"><p>5%</p></td>
<td class="text-left"><p>MCAR</p></td>
<td class="text-left"><p>Moda</p></td>
<td class="text-left"><p>Chi-cuadrado: p=0.6474</p></td>
<td class="text-left"><p>Cramér’s V: 0.007</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>nivel_educativo</strong></p></td>
<td class="text-left"><p>10%</p></td>
<td class="text-left"><p>MAR</p></td>
<td class="text-left"><p>Hot-deck</p></td>
<td class="text-left"><p>Chi-cuadrado: p=0.9834</p></td>
<td class="text-left"><p>Cramér’s V: 0.009</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>segmento</strong></p></td>
<td class="text-left"><p>20%</p></td>
<td class="text-left"><p>MAR</p></td>
<td class="text-left"><p>Hot-deck</p></td>
<td class="text-left"><p>Chi-cuadrado: p=0.9558</p></td>
<td class="text-left"><p>Cramér’s V: 0.007</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>estado_civil</strong></p></td>
<td class="text-left"><p>35%</p></td>
<td class="text-left"><p>MNAR</p></td>
<td class="text-left"><p>No imputado</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>Alto riesgo de sesgo</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>edad</strong></p></td>
<td class="text-left"><p>3%</p></td>
<td class="text-left"><p>MCAR</p></td>
<td class="text-left"><p>Mediana</p></td>
<td class="text-left"><p>KS: p=0.850; t-test: p=0.420</p></td>
<td class="text-left"><p>Cohen’s d: 0.032</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>altura_cm</strong></p></td>
<td class="text-left"><p>8%</p></td>
<td class="text-left"><p>MCAR</p></td>
<td class="text-left"><p>KNN</p></td>
<td class="text-left"><p>KS: p=0.994; t-test: p=0.999</p></td>
<td class="text-left"><p>Cohen’s d: 0.000</p></td>
<td class="text-left"><p>Distribución idéntica</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>gasto_mensual</strong></p></td>
<td class="text-left"><p>25%</p></td>
<td class="text-left"><p>MAR</p></td>
<td class="text-left"><p>KNN</p></td>
<td class="text-left"><p>KS: p=0.360; U-Mann: p=0.711</p></td>
<td class="text-left"><p>r biserial: 0.010</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>ingresos</strong></p></td>
<td class="text-left"><p>12%</p></td>
<td class="text-left"><p>MAR/MNAR</p></td>
<td class="text-left"><p>Regresión</p></td>
<td class="text-left"><p>KS: p=0.996; t-test: p=0.813</p></td>
<td class="text-left"><p>Cohen’s d: 0.011</p></td>
<td class="text-left"><p>Distribución preservada</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>demanda</strong></p></td>
<td class="text-left"><p>15%</p></td>
<td class="text-left"><p>MAR</p></td>
<td class="text-left"><p>MICE</p></td>
<td class="text-left"><p>KS: p=0.013; U-Mann: p=0.962</p></td>
<td class="text-left"><p>r biserial: -0.001</p></td>
<td class="text-left"><p>Leve cambio distribucional</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>puntuacion_credito</strong></p></td>
<td class="text-left"><p>50%</p></td>
<td class="text-left"><p>MNAR</p></td>
<td class="text-left"><p>No imputado</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>-</p></td>
<td class="text-left"><p>No imputable</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">&lt;no title&gt;</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importar-librerias">Importar Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-de-datos">Lectura de Datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-numericas">Variables Númericas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-categoricas">Variables Categóricas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#valores-nulos">Valores Nulos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-barras-de-los-valores-nulos">Gráfico de Barras de los Valores Nulos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapa-de-calor-de-los-valores-nulos">Mapa de Calor de los Valores Nulos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-del-tipo-de-dato-faltante-y-discusion-sobre-su-imputabilidad">Clasificación del Tipo de Dato Faltante y Discusión sobre su Imputabilidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-en-variables-numericas">Imputación en Variables Númericas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-edad">Variable ‘edad’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-altura-cm-y-gasto-mensual">Variables ‘altura_cm’ y ‘gasto_mensual’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-ingreso">Variable ‘ingreso’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-demanda">Variable ‘demanda’</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-en-variables-categoricas">Imputación en Variables Categóricas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-sexo-y-ciudad">Variables ‘sexo’ y ‘ciudad’</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-nivel-educativo-y-segmento">Variables ‘nivel_educativo’ y ‘segmento’</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-resumen">Tabla Resumen</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By David Marquez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>